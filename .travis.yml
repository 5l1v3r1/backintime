# TravisCI (https://travis-ci.org) configuration file
# https://docs.travis-ci.com/user/languages/python

language: python

# ensures that we have UUID filesystem mounts for proper testing
sudo: true

python:
  - "3.4"
#  - "3.5"
#  - "3.5-dev" # 3.5 development branch
#  - "nightly" # currently points to 3.6-dev

before_install:
  - sudo apt-get -qq update
  - sudo apt-get install -y sshfs
  # add travis user to fuse group
  - sudo gpasswd -a travis fuse
  #- sudo groupadd newtravisgroup

install:
  - pip install coveralls
  #- sudo usermod -a -G fuse,newtravisgroup $USER

script:
  # compile all files - ensure that syntax is correct
  #- mkdir newfile2
  #- ls -al .
  - pwd
  #- sudo -E su $USER -c "echo -e \"import os\nos.chown( 'newfile2', -1, 104 )\" | python"
  #- sudo -E su $USER -c "env"
  #- bash --login -c "env"
  #- env
  ##- sudo -E su $USER -c "bash --login -c 'env'"
  #- bash --login -c "chgrp fuse newfile2"
  #- sudo -E su $USER -c "bash --login -c 'chgrp fuse newfile2'"
  #- ls -al .
  #- sudo -E su $USER -c "bash --login -c 'python --version'"
  
  #- sudo -E su $USER -c 'python -m compileall common common/test common/plugins qt4 qt4/plugins'
  # run unit tests - ensure that functionality is correct
  #- which python
  #- which python3
  #- sudo -E su $USER -c 'python --version'
  #- sudo -E su $USER -c 'python3 --version'
  #- bash -c 'which python3'
  #- sudo -E su $USER -c -l 'which python3'
  - sudo -E su $USER -c "bash --login -c 'cd /home/travis/build/bit-team/backintime/common && ./configure && make unittest-v'"

after_success:
  - coverage combine
  - coveralls
